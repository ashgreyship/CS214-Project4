TODO:
1.segmentation fault when dir is empty
2.Cannot output all sorted rows
